import{S as Q,i as U,s as Z,e as L,b as M,B as A,h as k,k as O,l as P,m as D,n as x,L as $,p as f,w as ee,x as te,y as ne,f as se,t as ie,z as oe,H as de,o as pe,a as le,c as re,G as W,K as b,I as F,R as C,Q as me}from"./index-0618623f.js";import{P as ge,h as we,l as ve,S as X,s as _e,T as ke,e as E,a as I,p as H,g as xe}from"./PageWithNav-cb56c3e3.js";function N(s,e,t){const n=s.slice();return n[5]=e[t],n}function G(s){let e,t=s[2],n=[];for(let i=0;i<t.length;i+=1)n[i]=V(N(s,t,i));return{c(){e=O("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=P(i,"DIV",{class:!0});var l=D(e);for(let o=0;o<n.length;o+=1)n[o].l(l);l.forEach(k),this.h()},h(){x(e,"class","confetti svelte-1wlq4s8")},m(i,l){M(i,e,l);for(let o=0;o<n.length;o+=1)n[o].m(e,null)},p(i,l){if(l&4){t=i[2];let o;for(o=0;o<t.length;o+=1){const m=N(i,t,o);n[o]?n[o].p(m,l):(n[o]=V(m),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(i){i&&k(e),$(n,i)}}}function V(s){let e,t=s[5].character+"";return{c(){e=O("span"),this.h()},l(n){e=P(n,"SPAN",{class:!0,style:!0});var i=D(e);i.forEach(k),this.h()},h(){x(e,"class","confetti-piece svelte-1wlq4s8"),f(e,"left",s[5].x+"%"),f(e,"top",s[5].y+"%"),f(e,"--confetti-scale",s[5].r),f(e,"animation-duration",B*s[5].r+"s")},m(n,i){M(n,e,i),e.innerHTML=t},p(n,i){i&4&&t!==(t=n[5].character+"")&&(e.innerHTML=t),i&4&&f(e,"left",n[5].x+"%"),i&4&&f(e,"top",n[5].y+"%"),i&4&&f(e,"--confetti-scale",n[5].r),i&4&&f(e,"animation-duration",B*n[5].r+"s")},d(n){n&&k(e)}}}function Se(s){let e,t=s[0]&&!s[1]&&G(s);return{c(){t&&t.c(),e=L()},l(n){t&&t.l(n),e=L()},m(n,i){t&&t.m(n,i),M(n,e,i)},p(n,[i]){n[0]&&!n[1]?t?t.p(n,i):(t=G(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:A,o:A,d(n){t&&t.d(n),n&&k(e)}}}const B=2,R=50;function ye(s,e,t){let n,{show:i=!1}=e,l=50,o=!1,m=[`<svg width="${R}px" viewBox="0 0 24 97" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><path d="M5.572,1.5c0,4.434 -3.284,9.432 -0.044,13.618c1.673,2.162 10.2,3.431 9.106,-1.026c-1.069,-4.356 -5.61,-2.302 -7.579,-0.089c-3.73,4.195 -6.063,10.006 -5.461,15.652c0.64,5.997 4.428,11.642 9.733,14.522c1.524,0.828 5.58,2.42 6.93,0.372c1.381,-2.094 -2.775,-5.067 -4.275,-5.633c-3.61,-1.362 -6.744,1.352 -8.139,4.51c-4.399,9.962 0.272,23.069 11.681,25.374c3.769,0.762 5.671,-2.213 3.054,-5.187c-3.445,-3.915 -10.076,2.331 -12.153,4.803c-6.22,7.402 -8.916,21.705 1.639,26.849" style="fill:none;stroke:#f7e433;stroke-width:3px;"/></svg>`,`<svg width="${R}px" viewBox="0 0 26 90" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><path d="M4.297,1.5c6.757,3.868 20.271,11.605 20.162,17.991c-0.109,6.385 -20.46,14.809 -20.818,20.322c-0.358,5.513 19.001,5.226 18.669,12.756c-0.357,8.084 -13.992,26.53 -20.81,35.752" style="fill:none;stroke:#94e05c;stroke-width:3px;"/></svg>`,`<svg width="${R}px" viewBox="0 0 25 59" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><path d="M16.195,1.5c-5.234,4.623 -15.703,13.868 -14.617,19.602c1.087,5.734 19.85,8.792 21.134,14.802c1.285,6.011 -8.525,16.178 -13.429,21.262" style="fill:none;stroke:#d8301d;stroke-width:3px;"/></svg>`,`<svg width="${R}px" viewBox="0 0 28 74" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><path d="M13.586,1.5l-12.086,13.613l16.088,4.886l-11.716,11.555l17.96,11.761l-16.34,9.116l18.629,19.803" style="fill:none;stroke:#f59113;stroke-width:3px;"/></svg>`,`<svg width="${R}px" viewBox="0 0 24 57" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><path d="M1.5,1.505c2.256,-0 4.511,-0.06 6.754,0.239c18.635,2.486 -3.215,18.006 -1.664,25.182c2.935,13.572 25.21,10.8 11.109,28.53" style="fill:none;stroke:#80c0f2;stroke-width:3px;"/></svg>`];return s.$$set=d=>{"show"in d&&t(0,i=d.show)},s.$$.update=()=>{s.$$.dirty&3&&!o&&i&&setTimeout(()=>{t(1,o=!0)},B*1e3),s.$$.dirty&8&&t(2,n=new Array(l).fill("").map((d,c)=>({character:m[c%m.length],x:c/l*100,y:-10-Math.random()*10,r:1+Math.random()*1})).sort((d,c)=>d.r-c.r))},window.innerWidth<600?t(3,l=12):t(3,l=Math.floor(window.innerWidth*.05)),[i,o,n,l]}class be extends Q{constructor(e){super(),U(this,e,ye,Se,Z,{show:0})}}function q(s,e,t){const n=s.slice();return n[18]=e[t],n}function J(s){let e,t,n,i,l,o,m;return{c(){e=O("div"),t=O("img"),i=le(),this.h()},l(d){e=P(d,"DIV",{class:!0,style:!0,draggable:!0});var c=D(e);t=P(c,"IMG",{src:!0,style:!0,class:!0}),i=re(c),c.forEach(k),this.h()},h(){F(t.src,n=`${s[0]}/output_${s[18].imageRow}_${s[18].imageCol}.jpg`)||x(t,"src",n),f(t,"width",s[5]+"px"),f(t,"height",s[4]+"px"),f(t,"max-width",s[9]+"px"),f(t,"max-height",s[8]+"px"),x(t,"class","svelte-wvsjt6"),x(e,"class","draggable svelte-wvsjt6"),f(e,"outline-width",(s[3]?0:1)+"px"),x(e,"draggable",l=!s[3])},m(d,c){M(d,e,c),W(e,t),W(e,i),o||(m=[b(e,"mousedown",s[10]),b(e,"mouseup",function(){C(s[12](s[18]))&&s[12](s[18]).apply(this,arguments)}),b(e,"touchstart",s[10]),b(e,"touchmove",s[11]),b(e,"touchend",function(){C(s[12](s[18]))&&s[12](s[18]).apply(this,arguments)}),b(e,"change",function(){C(s[13](s[18]))&&s[13](s[18]).apply(this,arguments)})],o=!0)},p(d,c){s=d,c&65&&!F(t.src,n=`${s[0]}/output_${s[18].imageRow}_${s[18].imageCol}.jpg`)&&x(t,"src",n),c&32&&f(t,"width",s[5]+"px"),c&16&&f(t,"height",s[4]+"px"),c&8&&f(e,"outline-width",(s[3]?0:1)+"px"),c&8&&l!==(l=!s[3])&&x(e,"draggable",l)},d(d){d&&k(e),o=!1,me(m)}}}function Me(s){let e,t,n,i,l,o,m,d;t=new be({props:{show:s[3]}});let c=s[6],p=[];for(let r=0;r<c.length;r+=1)p[r]=J(q(s,c,r));return{c(){e=O("div"),ee(t.$$.fragment),n=le(),i=O("div"),l=O("div");for(let r=0;r<p.length;r+=1)p[r].c();this.h()},l(r){e=P(r,"DIV",{class:!0});var a=D(e);te(t.$$.fragment,a),a.forEach(k),n=re(r),i=P(r,"DIV",{class:!0,style:!0});var v=D(i);l=P(v,"DIV",{id:!0,class:!0,style:!0});var g=D(l);for(let S=0;S<p.length;S+=1)p[S].l(g);g.forEach(k),v.forEach(k),this.h()},h(){x(e,"class","confetti"),x(l,"id","puzzle"),x(l,"class","board svelte-wvsjt6"),f(l,"--num-cols",s[1]),f(l,"--num-rows",s[2]),f(l,"gap",(s[3]?0:1)+"px"),x(i,"class","board-wrapper svelte-wvsjt6"),f(i,"height",s[7]+"px")},m(r,a){M(r,e,a),ne(t,e,null),M(r,n,a),M(r,i,a),W(i,l);for(let v=0;v<p.length;v+=1)p[v].m(l,null);o=!0,m||(d=b(i,"mousemove",s[11]),m=!0)},p(r,a){const v={};if(a&8&&(v.show=r[3]),t.$set(v),a&16249){c=r[6];let g;for(g=0;g<c.length;g+=1){const S=q(r,c,g);p[g]?p[g].p(S,a):(p[g]=J(S),p[g].c(),p[g].m(l,null))}for(;g<p.length;g+=1)p[g].d(1);p.length=c.length}(!o||a&2)&&f(l,"--num-cols",r[1]),(!o||a&4)&&f(l,"--num-rows",r[2]),(!o||a&8)&&f(l,"gap",(r[3]?0:1)+"px"),(!o||a&128)&&f(i,"height",r[7]+"px")},i(r){o||(se(t.$$.fragment,r),o=!0)},o(r){ie(t.$$.fragment,r),o=!1},d(r){r&&k(e),oe(t),r&&k(n),r&&k(i),$(p,r),m=!1,d()}}}function Oe(s){let e,t;return e=new ge({props:{parent:"/puzzle",overflowHidden:!0,$$slots:{default:[Me]},$$scope:{ctx:s}}}),{c(){ee(e.$$.fragment)},l(n){te(e.$$.fragment,n)},m(n,i){ne(e,n,i),t=!0},p(n,[i]){const l={};i&2097407&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(se(e.$$.fragment,n),t=!0)},o(n){ie(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}const K=512;function Pe(s){let e;for(let t=0;t<s.length;t++)if(e=t+1,s[e]-s[t]<0)return!1;return!0}function ze(s,e,t){let n;de(s,we,u=>t(7,n=u));let{imageSrcRoot:i}=e,{numCols:l}=e,{numRows:o}=e,m=!1,d=0,c=0,p=K/o,r=K/l,a=[];pe(()=>{ve([X.BLOP,X.SWOOSH]);let u=0;for(let w=0;w<o;w++)for(let _=0;_<l;_++)a.push({imageRow:w,imageCol:_,id:u++});const h=a;for(;JSON.stringify(h)===JSON.stringify(a);)t(6,a=_e(a));return t(6,a=[...a]),window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}});const v=new Map,g=ke.DRAG_ONLY,S=u=>{if(!m){u.preventDefault();const h=E(u),w=I(h);v.set(w,{pageX:h.pageX,pageY:h.pageY,clientX:h.clientX,clientY:h.clientY,originPageX:h.pageX,originPageY:h.pageY,isScroll:!1,target:u.target,touchMode:g})}},ae=u=>{const h=E(u),w=I(h),_=v.get(w);if(_!=null){const z={..._,clientX:h.clientX,clientY:h.clientY,pageX:h.pageX,pageY:h.pageY},y=z.pageX-_.pageX,T=z.pageY-_.pageY,Y=_.target;Y.style.transform=`translateX(${y}px) translateY(${T}px)`,Y.style.zIndex="2"}},ce=u=>h=>{const w=E(h),_=I(w);if(v.get(_)!=null){const y=w.target;y.style.transform="",y.style.zIndex="";const Y=document.elementsFromPoint(w.pageX,w.pageY)[0];if(Y.getAttribute("draggable")){const he=new CustomEvent("change",{detail:{tile:u}});Y.dispatchEvent(he)}else H(X.SWOOSH);v.delete(_)}},fe=u=>h=>{const w=h.detail.tile;if(w.id===u.id)H(X.SWOOSH);else{H(X.BLOP);const z=a.indexOf(w),y=a.indexOf(u);t(6,[a[z],a[y]]=[a[y],a[z]],a),t(6,a=[...a]),t(3,m=Pe(a.map(T=>T.id))),xe.set(m)}};function ue(){const h=Math.min(window.innerWidth,window.innerHeight)-10;t(4,d=h/o),t(5,c=h/l)}const j=()=>{ue()};return s.$$set=u=>{"imageSrcRoot"in u&&t(0,i=u.imageSrcRoot),"numCols"in u&&t(1,l=u.numCols),"numRows"in u&&t(2,o=u.numRows)},j(),[i,l,o,m,d,c,a,n,p,r,S,ae,ce,fe]}class Xe extends Q{constructor(e){super(),U(this,e,ze,Oe,Z,{imageSrcRoot:0,numCols:1,numRows:2})}}export{Xe as P};
